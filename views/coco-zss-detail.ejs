<style type="text/css">
    * {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }

    /* force scrollbar */
    html {
        overflow-y: scroll;
    }

    body {
        font-family: sans-serif;
    }

    /* ---- isotope ---- */

    .grid {
        background: #DDD;
    }

    /* clear fix */
    .grid:after {
        content: '';
        display: block;
        clear: both;
    }

    /* ---- .grid-item ---- */

    .grid-sizer,
    .grid-item {
        width: 25%;
        margin-top: 20px;
    }

    .grid-item {
        float: left;
    }

    .grid-item img {
        display: block;
        max-width: 100%;
    }

    #upload_files_area {
        margin-top: 10px;
    }

    #upload_process {
        margin-top: 10px;
    }

</style>
<script type="text/javascript">
    $(function () {
        // 文件上传
        $('#fileupload').fileupload({
            url: '/ajax/upload/',
            progressInterval: 100,
            bitrateInterval: 100,
            sequentialUploads: true,
            dataType: 'json',
            progress: function (e, data) {
                console.log(data)
                var process = ((data.loaded / data.total).toFixed(2)) * 100 + "%"
                $('#upload_process').text("当前进度" + process)
            },
            done: function (e, data) {
                var image_url = "/images/" + data.result['sha1'];
                $('#upload_files_area').html('<img style="max-width:220px;max-height:220px;" src=' + image_url + '>');
                $('.upload-title').text('重新选择');
                $('#fileupload').attr("imagesha1", data.result['sha1']);
            }
        });

        var $grid = $('.grid').masonry({
            itemSelector: '.grid-item',
            percentPosition: true,
            columnWidth: '.grid-sizer'
        });
        // layout Isotope after each image loads
        $grid.imagesLoaded().progress(function () {
            $grid.masonry();
        });
    });
</script>
<div style="border-top: 2px solid #000;width: 100%;background-color: rgba(0,0,0,0.7)">
    <h3 style="color: #fff">作品详情<span class="btn btn-success btn-sm pull-right">
                    <a style="color: #fff;font-size: 15px;" data-toggle="modal"
                       data-target=".upload_picture_modal">上传作品</a>
                </span></h3>

    <div id="image_container" class="row">
        <div class="col-xs-6 col-sm-4 col-md-3 col-lg-3" ng-repeat="work in work_list" style="margin: 10px 0px">
            <a href="/images/{{work.file_sha1}}" data-lightbox="image" data-title="{{work.note}}">
                <img class="img-responsive" src="/images/{{work.file_sha1}}">
            </a>

            <div style="padding: 5px;border-top: 1px solid #F2F2F2;background: #FAFAFA;">
                <p style="margin: 0px;padding: 3px;font-size: 12px;color: #666;">{{work.note}}
                    <a style="float: right" sha1="{{work.file_sha1}}" href="javascript:void(0)"
                       ng-click="deleteWork(this)">删除</a></p>
            </div>
        </div>
    </div>
</div>